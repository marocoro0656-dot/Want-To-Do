
{% extends 'todo/base.html' %}
{% load static %}
{% block extra_css %}<link rel="stylesheet" href="{% static 'todo/home.css' %}">{% endblock %}

{% block content %}
  <div class="filter-box" style="max-width:900px;">
    <h3 style="text-align:center; margin-bottom:16px;">完了済みのWant To Do</h3>

    {% if wants %}
      <ul class="todo-list">
        {% for w in wants %}
          <li class="todo-item">
            <div class="todo-main">
              <div class="todo-title">
                {{ w.title }}
                <span class="badge-diff
                  {% if w.difficulty == 'high' %}high
                  {% elif w.difficulty == 'medium' %}medium
                  {% else %}low{% endif %}
                ">{{ w.get_difficulty_display }}</span>
                
                <span class="done-badge">
                  {% if w.completed_at %}
                    {{ w.completed_at|date:"n/j" }} 完了
                  {% else %}
                    完了
                  {% endif %}
                </span>
              </div>
              <div class="todo-sub">
                {% if w.deadline %}期限：{{ w.deadline }}{% else %}期限未設定{% endif %}
                {% if w.category %}<span class="todo-cat"> / {{ w.get_category_display }}</span>{% endif %}
                {% if w.difficulty %}<span class="todo-cat"> / {{ w.get_difficulty_display }}</span>{% endif %}
              </div>
              {% if w.memo %}<div class="todo-memo">{{ w.memo }}</div>{% endif %}
            </div>
          </li>
        {% endfor %}
      </ul>

      {% if page_obj.paginator.num_pages > 1 %}
      <div class="pagination-center">
        <nav aria-label="pagination">
          <ul class="pagination">
            {% if page_obj.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">前へ</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">前へ</span></li>
            {% endif %}

            <li class="page-item disabled"><span class="page-link">{{ page_obj.number }}/{{ page_obj.paginator.num_pages }}</span></li>

            {% if page_obj.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">次へ</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">次へ</span></li>
            {% endif %}
          </ul>
        </nav>
      </div>
      {% endif %}
    {% else %}
      <p class="signup-help" style="text-align:center">完了済みの WantToDo はありません。</p>
    {% endif %}
  </div>

  <div class="bottom-button">
    <a href="{% url 'todo_app:incomplete_list' %}" class="btn btn-gray">未完了Want To Do一覧へ</a>
  </div>
{% endblock %}
